# Niffler Multi-Agent Configuration Example
#
# Place this file in ~/.niffler/config.yaml (Unix) or
# %APPDATA%/niffler/config.yaml (Windows)

# Your name used in prompts
your_name: "Developer"

# ---------------------------------------------------------------------------
# Model Configurations
# ---------------------------------------------------------------------------
models:
  - nickname: "gpt-4o"
    base_url: "https://api.openai.com/v1"
    model: "gpt-4o"
    context: 8192
    enabled: true

    # OpenAI protocol parameters
    temperature: 0.7
    top_p: 0.95
    # max_tokens: 4096  # Uncomment to set explicit token limit

    # Cost tracking (optional)
    # input_cost_per_mtoken: 0.005  # Cost per 1 million input tokens
    # output_cost_per_mtoken: 0.015 # Cost per 1 million output tokens

  - nickname: "claude-sonnet"
    base_url: "https://api.anthropic.com/v1"
    model: "claude-3-5-sonnet-20241022"
    context: 200000
    enabled: true
    api_env_var: "ANTHROPIC_API_KEY"

    # Cost tracking
    input_cost_per_mtoken: 0.003
    output_cost_per_mtoken: 0.015

  - nickname: "haiku"
    base_url: "https://api.anthropic.com/v1"
    model: "claude-3-5-haiku-20241022"
    context: 200000
    enabled: true
    api_env_var: "ANTHROPIC_API_KEY"

    # Cheaper model for simple tasks
    input_cost_per_mtoken: 0.00025
    output_cost_per_mtoken: 0.00125

# ---------------------------------------------------------------------------
# Multi-Agent Configuration
# ---------------------------------------------------------------------------

nats:
  # NATS server for inter-process communication
  server: "nats://localhost:4222"
  timeout_ms: 30000
  reconnect_attempts: 5
  reconnect_delay_ms: 1000

master:
  # Master mode settings
  enabled: false  # Set to true when running --master
  default_agent: "coder"
  auto_start_agents: true
  heartbeat_check_interval: 30

# ---------------------------------------------------------------------------
# Agent Definitions
# Each agent is a persistent process with specialized capabilities
# ---------------------------------------------------------------------------

agents:
  - id: "coder"
    name: "Code Expert"
    description: "Specialized in code analysis, debugging, and implementation"
    model: "claude-sonnet"  # Use model nickname from above

    # Capabilities for smart routing suggestions
    capabilities:
      - "coding"
      - "debugging"
      - "architecture"
      - "refactoring"
      - "testing"

    # Tool permissions (enforced by agent)
    tool_permissions:
      - "read"
      - "edit"
      - "create"
      - "bash"
      - "list"
      - "fetch"

    # Lifecycle settings
    auto_start: true
    persistent: true  # Keep agent running even when idle

  - id: "researcher"
    name: "Research Assistant"
    description: "Fast research, documentation lookup, and web search"
    model: "haiku"  # Cheaper model for research tasks

    capabilities:
      - "research"
      - "documentation"
      - "web_search"
      - "analysis"

    tool_permissions:
      - "read"
      - "list"
      - "fetch"  # Read-only for research

    auto_start: false
    persistent: false  # Ephemeral - shutdown after 10 minutes idle
    max_idle_seconds: 600

  - id: "bash_helper"
    name: "Bash Helper"
    description: "System commands, testing, and DevOps operations"
    model: "gpt-4o"

    capabilities:
      - "system"
      - "commands"
      - "testing"
      - "devops"

    tool_permissions:
      - "bash"
      - "read"
      - "list"

    auto_start: true
    persistent: true

  - id: "reviewer"
    name: "Security Reviewer"
    description: "Code review, security analysis, and best practices"
    model: "gpt-4o"  # Good at code review and security

    capabilities:
      - "review"
      - "security"
      - "quality"
      - "best_practices"

    tool_permissions:
      - "read"
      - "list"  # Read-only for reviews

    auto_start: false
    persistent: false
    max_idle_seconds: 1800

# ---------------------------------------------------------------------------
# Database Configuration
# ---------------------------------------------------------------------------

database:
  type: "sqlite"
  enabled: true
  path: "~/.niffler/niffler.db"  # Will be expanded to full path
  wal_mode: true
  busy_timeout: 5000
  pool_size: 10

# ---------------------------------------------------------------------------
# Theme Configuration (Optional)
# ---------------------------------------------------------------------------

# current_theme: "dark"  # Uncomment to set theme

# themes:
#   - name: "dark"
#     header1:
#       color: "cyan"
#       style: "bright"
#     header2:
#       color: "blue"
#       style: "bright"
#     bold:
#       color: "white"
#       style: "bright"

# ---------------------------------------------------------------------------
# UI Settings
# ---------------------------------------------------------------------------

markdown_enabled: true

# ---------------------------------------------------------------------------
# External Rendering (Optional)
# ---------------------------------------------------------------------------

# external_rendering:
#   enabled: true
#   content_renderer: "batcat --color=always --style=numbers --theme=auto {file}"
#   diff_renderer: "delta --line-numbers --syntax-theme=auto"
#   fallback_to_builtin: true

# ---------------------------------------------------------------------------
# Web Content Text Extraction (Optional)
# ---------------------------------------------------------------------------

# text_extraction:
#   enabled: false
#   command: "trafilatura -u {url}"
#   mode: "url"  # "url" or "stdin"
#   fallback_to_builtin: true

# ---------------------------------------------------------------------------
# Agent Settings (Optional)
# ---------------------------------------------------------------------------

# agent_timeout_seconds: 300  # 5 minutes for agent response timeout

# ---------------------------------------------------------------------------
# Active Configuration Directory (Optional)
# ---------------------------------------------------------------------------

# config: "/path/to/project/.niffler"  # Project-specific config